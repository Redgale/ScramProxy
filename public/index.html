<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Zen Browser</title>
    <style>
        :root { --bg: #0d0d0f; --nav: #16161a; --accent: #8b5cf6; --text: #f4f4f5; --border: #27272a; }
        body { margin: 0; background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        .tab-bar { display: flex; background: #000; padding: 5px 10px 0; gap: 4px; border-bottom: 1px solid var(--border); }
        .tab { padding: 8px 15px; background: var(--nav); border-radius: 8px 8px 0 0; font-size: 12px; cursor: pointer; border: 1px solid var(--border); border-bottom: none; display: flex; align-items: center; gap: 8px; min-width: 120px; max-width: 200px; }
        .tab.active { background: var(--accent); color: white; border-color: var(--accent); }
        .tab img { width: 14px; height: 14px; border-radius: 2px; }
        
        .navbar { background: var(--nav); padding: 8px 15px; display: flex; gap: 10px; align-items: center; }
        .omnibox { flex-grow: 1; background: #000; border: 1px solid var(--border); padding: 8px 15px; border-radius: 20px; color: #fff; outline: none; }
        .omnibox:focus { border-color: var(--accent); }
        
        .btn { background: none; border: 1px solid var(--border); color: var(--text); padding: 5px 10px; border-radius: 6px; cursor: pointer; }
        .btn:hover { border-color: var(--accent); }
        
        .view-area { flex-grow: 1; background: #fff; position: relative; }
        iframe { width: 100%; height: 100%; border: none; display: none; }
        iframe.active { display: block; }
    </style>
</head>
<body>

<div class="tab-bar" id="tab-bar">
    <button class="btn" onclick="addTab()" style="margin-bottom:5px">+</button>
</div>

<div class="navbar">
    <button class="btn" onclick="goBack()">‚Üê</button>
    <button class="btn" onclick="reload()">‚Üª</button>
    <input type="text" id="url-input" class="omnibox" placeholder="Enter URL or search Google..." onkeydown="if(event.key==='Enter') navigate()">
    <button class="btn" onclick="cloak('about:blank')">üï∂Ô∏è Cloak</button>
</div>

<div class="view-area" id="view-area"></div>

<script>
    let tabs = [];
    let activeId = null;

    function addTab() {
        const id = 't' + Date.now();
        const tabBtn = document.createElement('div');
        tabBtn.className = 'tab';
        tabBtn.id = `btn-${id}`;
        tabBtn.innerHTML = `<img src="https://www.google.com/favicon.ico" id="fav-${id}"> <span id="title-${id}">New Tab</span>`;
        tabBtn.onclick = () => switchTab(id);
        document.getElementById('tab-bar').insertBefore(tabBtn, document.getElementById('tab-bar').firstChild);

        const ifr = document.createElement('iframe');
        ifr.id = `frame-${id}`;
        document.getElementById('view-area').appendChild(ifr);

        tabs.push(id);
        switchTab(id);
    }

    function switchTab(id) {
        document.querySelectorAll('.tab, iframe').forEach(el => el.classList.remove('active'));
        activeId = id;
        document.getElementById(`btn-${id}`).classList.add('active');
        document.getElementById(`frame-${id}`).classList.add('active');
    }

    function navigate() {
        let val = document.getElementById('url-input').value.trim();
        if (!val) return;

        // Omnibox Logic: URL vs Search
        const isUrl = val.includes('.') && !val.includes(' ');
        const url = isUrl ? (val.startsWith('http') ? val : 'https://' + val) : 'https://www.google.com/search?q=' + encodeURIComponent(val);

        const frame = document.getElementById(`frame-${activeId}`);
        frame.src = `/s/${url}`;

        // Update Tab
        document.getElementById(`title-${activeId}`).innerText = isUrl ? val.split('/')[0] : 'Search';
        document.getElementById(`fav-${activeId}`).src = `https://www.google.com/s2/favicons?domain=${url}&sz=32`;
    }

    function cloak(type) {
        const url = window.location.href;
        const win = window.open('about:blank', '_blank');
        win.document.body.innerHTML = `<iframe src="${url}" style="width:100%;height:100%;border:none;position:fixed;top:0;left:0;"></iframe>`;
        win.document.title = "Google Drive"; // School-friendly title
    }

    function reload() { document.getElementById(`frame-${activeId}`).contentWindow.location.reload(); }
    function goBack() { document.getElementById(`frame-${activeId}`).contentWindow.history.back(); }

    addTab(); // Start with one tab
</script>
</body>
</html>